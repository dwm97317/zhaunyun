(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["store"],{"262b":function(e,t,r){"use strict";r("e897")},"73f5":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"g",(function(){return s})),r.d(t,"f",(function(){return i})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return d}));var n=r("f6ae"),a=r("b775");function o(e){return Object(a["b"])({url:n["a"].store.list,method:"get",params:e})}function s(e){var t=e.storeId;return Object(a["b"])({url:n["a"].store.superLogin,method:"get",params:{storeId:t}})}function i(e){return Object(a["b"])({url:n["a"].store.recycle,method:"get",params:e})}function c(e){return Object(a["b"])({url:n["a"].store.add,method:"post",data:e})}function l(e){return Object(a["b"])({url:n["a"].store.recovery,method:"post",data:e})}function u(e){return Object(a["b"])({url:n["a"].store.delete,method:"post",data:e})}function d(e){return Object(a["b"])({url:n["a"].store.move,method:"post",data:e})}},bb50:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("content-header",{attrs:{title:"商城列表"}}),t("div",{staticClass:"table-operator"},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.createModal.show()}}},[e._v("新增")])],1),t("s-table",{ref:"table",attrs:{size:"default",rowKey:"store_id",columns:e.columns,data:e.loadData,showPagination:"auto",pageSize:15},scopedSlots:e._u([{key:"action",fn:function(r,n){return t("span",{staticClass:"actions"},[t("a",{on:{click:function(t){return e.handleInto(n)}}},[e._v("进入商城")]),t("a",{on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")]),t("a",{on:{click:function(t){return e.handleModule(n)}}},[e._v("功能模块")])])}}])}),t("create-form",{ref:"createModal",on:{handleSubmit:e.handleRefresh}}),t("ModuleForm",{ref:"ModuleForm",on:{handleSubmit:e.handleRefresh}})],1)},a=[],o=r("73f5"),s=r("2af9"),i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"新增商城",width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"商城名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["store_name",{rules:[{required:!0,min:3,message:"请输入至少3个字符"}]}],expression:"['store_name', {rules: [{required: true, min: 3, message: '请输入至少3个字符'}]}]"}]})],1),t("a-form-item",{attrs:{label:"商家用户名",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"商家后台登录用户名"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["user_name",{rules:[{required:!0,min:4,message:"请输入至少4个字符"}]}],expression:"['user_name', {rules: [{required: true, min: 4, message: '请输入至少4个字符'}]}]"}]})],1),t("a-form-item",{attrs:{label:"用户密码",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"商家后台登录密码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,min:6,message:"请输入至少6个字符"}]}],expression:"['password', {rules: [\n            {required: true, min: 6, message: '请输入至少6个字符'}\n          ]}]"}],attrs:{type:"password"}})],1),t("a-form-item",{attrs:{label:"确认密码",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password_confirm",{rules:[{required:!0,message:"请输入确认密码"},{validator:e.compareToFirstPassword}]}],expression:"['password_confirm', {rules: [\n            {required: true, message: '请输入确认密码'},\n            {validator: compareToFirstPassword}\n          ]}]"}],attrs:{type:"password"}})],1),t("a-form-item",{attrs:{label:"排序",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"数字越小越靠前"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:100,rules:[{required:!0,message:"请输入至少1个数字"}]}],expression:"['sort', {initialValue: 100, rules: [{required: true, message: '请输入至少1个数字'}]}]"}],attrs:{min:0}})],1)],1)],1)],1)},c=[],l=(r("d3b7"),{data:function(){return{labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this)}},methods:{show:function(){this.visible=!0,this.form.resetFields()},handleSubmit:function(){var e=this,t=this.form.validateFields;t((function(t,r){!t&&e.onFormSubmit(r)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},compareToFirstPassword:function(e,t,r){var n=this.form;return!t||t===n.getFieldValue("password")||new Error("您输入的确认密码不一致")},onFormSubmit:function(e){var t=this;this.confirmLoading=!0,Object(o["a"])({form:e}).then((function(r){t.$message.success(r.message,1.2),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(e){t.confirmLoading=!1}))}}}),u=l,d=r("2877"),f=Object(d["a"])(u,i,c,!1,null,null,null),h=f.exports,m=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"商城名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("span",{staticStyle:{"margin-left":"23px",color:"rgba(0, 0, 0, 0.85)"}},[e._v(e._s(e.record.store_name))])]),t("a-form-item",{attrs:{label:"模块列表",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"设置当前商城可使用的功能模块"}},[t("a-tree",{ref:"ModuleTree",attrs:{checkable:"",checkStrictly:"",treeData:e.treeData,autoExpandParent:!1},on:{check:e.onCheckedModule},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}})],1)],1)],1)],1)},b=[],p=r("2909"),v=r("c7eb"),g=r("1da1"),k=(r("b0c0"),r("99af"),r("159b"),r("2ef0")),w=r.n(k),C=r("f6ae"),y=r("b775");function _(e){return Object(y["b"])({url:C["a"].store.module.default,method:"get",params:e})}function x(e){return Object(y["b"])({url:C["a"].store.module.detail,method:"get",params:e})}function O(e){return Object(y["b"])({url:C["a"].store.module.edit,method:"post",data:e})}var S={props:{},data:function(){return{title:"设置功能模块",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{},default:{},moduleKeys:{},treeData:[],checkedKeys:{checked:[],halfChecked:[]}}},created:function(){this.getDefault()},methods:{show:function(e){var t=this;return Object(g["a"])(Object(v["a"])().mark((function r(){return Object(v["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.visible=!0,t.record=e,r.next=4,t.getModuleDetail(e);case 4:t.getTreeData(),t.setModuleChecked();case 6:case"end":return r.stop()}}),r)})))()},getTreeData:function(){this.treeData=this.formatTreeData(this.default)},getDefault:function(){var e=this;return Object(g["a"])(Object(v["a"])().mark((function t(){return Object(v["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.confirmLoading=!0,t.next=3,_().then((function(e){return e.data.default}));case 3:e.default=t.sent,e.confirmLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},setModuleChecked:function(){var e=this.treeData,t=this.moduleKeys,r=this.getAllKeys(e);this.checkedKeys.checked=w.a.intersection(t,r)},getModuleDetail:function(e){var t=this;return Object(g["a"])(Object(v["a"])().mark((function r(){return Object(v["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.confirmLoading=!0,r.next=3,x({storeId:e["store_id"]}).then((function(e){return e.data.moduleKeys}));case 3:t.moduleKeys=r.sent,t.confirmLoading=!1;case 5:case"end":return r.stop()}}),r)})))()},formatTreeData:function(e,t){var r=[];for(var n in e){var a=e[n],o={title:a.name,key:a.key,checkable:!a.required,parentKey:t};a.children&&(o["children"]=this.formatTreeData(a["children"],a.key)),r.push(o)}return r},handleSubmit:function(){var e=this.$refs.ModuleTree,t={moduleKeys:[].concat(Object(p["a"])(e.getCheckedKeys()),Object(p["a"])(e.getHalfCheckedKeys()))};this.onFormSubmit(t)},handleCancel:function(){this.visible=!1,this.form.resetFields();var e=this.$refs.ModuleTree;e.clearExpandedKeys(),this.checkedKeys.checked=[]},onFormSubmit:function(e){var t=this;this.confirmLoading=!0,O({storeId:this.record["store_id"],form:e}).then((function(r){t.$message.success(r.message),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){return t.confirmLoading=!1}))},onCheckedModule:function(e,t){var r=t.checked,n=t.node,a=this.treeData,o=this.findNode(n.eventKey,a);this.onCheckChilds(r,o),this.onCheckParents(r,o)},findNode:function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(n.key===e)return n;if(n.children){var a=this.findNode(e,n.children);if(a)return a}}return!1},onCheckParents:function(e,t){var r=this,n=this.treeData,a=function e(t){var a=[],o=r.findNode(t,n);if(!o)return a;if(a.push(o.key),o.children){var s=e(o.parentKey);s.length&&(a=a.concat(s))}return a},o=a(t.parentKey);e&&o.length&&(this.checkedKeys.checked=w.a.union(this.checkedKeys.checked,o))},onCheckChilds:function(e,t){var r=t.children?this.getAllKeys(t.children):[];r.length&&(this.checkedKeys.checked=e?w.a.union(this.checkedKeys.checked,r):w.a.difference(this.checkedKeys.checked,r))},getAllKeys:function(e){var t=this,r=[];return e.forEach((function(e){if(r.push(e.key),e.children&&e.children.length){var n=t.getAllKeys(e.children);n.length&&(r=r.concat(n))}})),r}}},j=S,D=(r("262b"),Object(d["a"])(j,m,b,!1,null,"c0113e94",null)),K=D.exports,I=r("ca00"),L={components:{ContentHeader:s["a"],STable:s["d"],CreateForm:h,ModuleForm:K},data:function(){var e=this;return{queryParam:{},columns:[{title:"商城ID",dataIndex:"store_id"},{title:"商城名称",dataIndex:"store_name"},{title:"排序",dataIndex:"sort"},{title:"添加时间",dataIndex:"create_time"},{title:"操作",dataIndex:"action",width:"200px",scopedSlots:{customRender:"action"}}],loadData:function(t){return o["c"](Object.assign(t,e.queryParam)).then((function(e){return e.data.list}))}}},created:function(){},methods:{handleInto:function(e){var t=window.serverConfig.STORE_URL;o["g"]({storeId:e.store_id}).then((function(e){var r=e.data,n="".concat(t,"/#/passport/login?")+Object(I["d"])({superLogin:!0,userId:r.userId,token:r.token});window.open(n,"_blank")}))},handleDelete:function(e){var t=this;t.$confirm({title:"您确定要删除该商城吗?",content:"确认后将移入回收站",onOk:function(){return t.onSubmitDelete(e)}})},onSubmitDelete:function(e){var t=this;return o["e"]({storeId:e["store_id"]}).then((function(e){t.$message.success(e.message),t.handleRefresh()}))},handleModule:function(e){this.$refs.ModuleForm.show(e)},handleRefresh:function(){this.$refs.table.refresh()}}},F=L,R=Object(d["a"])(F,n,a,!1,null,null,null);t["default"]=R.exports},bb70:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("content-header",{attrs:{title:"回收站"}}),t("s-table",{ref:"table",attrs:{size:"default",rowKey:"store_id",columns:e.columns,data:e.loadData,showPagination:"auto",pageSize:15},scopedSlots:e._u([{key:"action",fn:function(r,n){return t("span",{staticClass:"actions"},[t("a",{on:{click:function(t){return e.handleReturn(n)}}},[e._v("还原")]),t("a",{on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])])}}])})],1)},a=[],o=r("73f5"),s=r("2af9"),i={name:"TableList",components:{ContentHeader:s["a"],STable:s["d"]},data:function(){var e=this;return{queryParam:{},columns:[{title:"商城ID",dataIndex:"store_id",scopedSlots:{customRender:"store_id"}},{title:"商城名称",dataIndex:"store_name",scopedSlots:{customRender:"store_name"}},{title:"添加时间",dataIndex:"create_time",scopedSlots:{customRender:"create_time"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(o["f"])(Object.assign(t,e.queryParam)).then((function(e){return e.data.list}))}}},created:function(){},methods:{handleReturn:function(e){var t=this;t.$confirm({title:"您确定要还原该商城吗?",onOk:function(){return t.onSubmitReturn(e)}})},handleDelete:function(e){var t=this;t.$confirm({title:"您确定要删除该记录吗?",content:"删除后将无法恢复",onOk:function(){return t.onSubmitDelete(e)}})},onSubmitReturn:function(e){var t=this;return Object(o["d"])({storeId:e["store_id"]}).then((function(e){t.$message.success(e.message),t.handleRefresh()}))},onSubmitDelete:function(e){var t=this;return Object(o["b"])({storeId:e["store_id"]}).then((function(e){t.$message.success(e.message),t.handleRefresh()}))},handleRefresh:function(){this.$refs.table.refresh()}}},c=i,l=r("2877"),u=Object(l["a"])(c,n,a,!1,null,null,null);t["default"]=u.exports},e897:function(e,t,r){}}]);